"use strict";var commHelper={isInternetExplorer:function(){return 0<=navigator.userAgent.toLowerCase().indexOf("msie")},isUndefined:function(e){return void 0===e},isNumber:function(e){return!Number.isNaN(e)},isString:function(e){return"string"==typeof e},isDate:function(e){return e&&"[object Date]"===toString.call(e)&&!Number.isNaN(e)},isDateString:function(e){var t=new Date(e);return!Number.isNaN(t.getDate())},isFunction:function(e){return"function"==typeof e},isJSON:function(e){return"[object Object]"===Object.prototype.toString.call(e)},isArray:function(e){return $.isArray(e)},isEmpty:function(e){return null==e||""===e},isEmptyArray:function(e){var t=this.isArray(e);return!0===t?0===e.length:t},isEmptyLookup:function(e){return-1===e||0===e||"-1"===e||"0"===e||this.isEmpty(e)},isPhonenumberCl:function(e){return!this.isEmpty(e)&&!!e.match(/^(\+?56)?(\s?)(0?9)(\s?)[9876543]\d{7}$/)},isEmail:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},isStringValid:function(e,t,n){var o=this.getString(e);return!(o.length<t||o.length>n)},getString:function(e,t){return t=this.isEmpty(t)?"":t,this.isEmpty(e)?t:e},getBool:function(e){return!this.isEmpty(e)&&!("on"!==e&&"true"!==e&&!0!==e)},getDate:function(e){var t=this.isEmpty(e)?null:e;return null!==t&&(t=null!==(t=this.isString(t)?this.isDateString(t)?new Date(t):null:t)&&this.isDate(t)?t:null),t},getInteger:function(e,t){return this.isEmpty(e)?t:this.getNumber(e,t,0)},getNumber:function(e,t,n){var o=this.isEmpty(t)?0:t,i=this.isEmpty(n)?2:n,a=this.isEmpty(e)?o:e.toString().replace(/\$|,/g,""),a=Number.isNaN(a)?o:a;return a=Number(parseInt(a,10).toFixed(i))},getNumberFromString:function(e){var t;return"string"!=typeof e||null!==(t=e.match(/[0-9,.]+/g))&&(e=t[0].replace(/,/g,""),e=parseFloat(e)),e},getDateStringfromISO:function(e){var t=this.isEmpty(e)?"":new Date(e);return""===t?t:"".concat(this.appendLeadingZeroes(t.getDate()),"-").concat(this.appendLeadingZeroes(t.getMonth()+1),"-").concat(t.getFullYear())},getDatefromISO:function(e){return this.isEmpty(e)?null:new Date(e)},setDateToISO:function(e,t){return t=this.isEmpty(t)?"T12:00:00Z":t,"".concat(e.getFullYear(),"-").concat(this.appendLeadingZeroes(e.getMonth()+1),"-").concat(this.appendLeadingZeroes(e.getDate())).concat(t)},setDateToISOFilter:function(e){return{ini:this.setDateToISO(e,"T00:00:00Z"),end:this.setDateToISO(e,"T23:59:59Z")}},getMoneyformat:function(e,t,n,o){t=Number.isNaN(t=Math.abs(t))?2:t,n=void 0===n?".":n,o=void 0===o?",":o;var i=e<0?"-":"",a="".concat(parseInt(e=Math.abs(+e||0).toFixed(t),10)),c=3<(c=a.length)?c%3:0;return i+(c?a.substr(0,c)+o:"")+a.substr(c).replace(/(\d{3})(?=\d)/g,"$1".concat(o))+(t?n+Math.abs(e-a).toFixed(t).slice(2):"")},getUrlParameter:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]".concat(e,"=([^&#]*)")).exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},urlformat:function(e,t){!0===langsupport&&"?lg=".concat(APP_PAGE.lang);var n=0<=e.indexOf("?")?"&":"?";return e+(t=this.isEmpty(t)?"":n+t)},redirect:function(e,t){window.location.replace(this.urlformat(e,t))},redirectTime:function(e,t){var n=this;this.isEmpty(e)||setTimeout(function(){window.location.replace(n.urlformat(e,t))},500)},redirectNewWindow:function(e){window.open(e,"_blank").focus()},appendLeadingZeroes:function(e){return e<=9?"0".concat(e):e},findInArray:function(e,n,o,i){var a=this;if(a.isEmpty(e)||!a.isArray(e))return null;if(a.isEmpty(n))return null;var t=$.grep(e,function(e,t){return a.isEmpty(i)?e[o]===n:this.isEmpty(e[o][i])?null:e[o][i]===n},!1);return 0<t.length?t:null},getValueFromObject:function(e,t){try{if(this.isEmpty(e))return null;var n=e;return $.each(t,function(e,t){return-1===Object.keys(n).indexOf(t)?null:void(n=n[t])}),n}catch(e){return""}},getjsonfromUrl:function(e){var t=jQuery.ajax({type:"GET",url:e,cache:!1,async:!1}).responseText;return JSON.parse(t)}},woocfcl_settings=function(p){var i,e="undefined"!=typeof woocfcl_countries?woocfcl_countries:null,t="undefined"!=typeof woocfcl_options?woocfcl_options:null,n="undefined"!=typeof woocfcl_config?woocfcl_config:null,a=0,o=n.lang.shortlang,c=commHelper.getjsonfromUrl("/wp-content/plugins/woo-chile-custom/assets/admin/js/i18n/".concat(o,".json")),l=p(".container"),r=p("#loader"),s=p("#EditFieldModal").modal(),d="<tr>";d+='<td style="width:150px;"><input type="text" name="i_options_key[]" placeholder="Option Value" style="width:140px;"/></td>',d+='<td style="width:190px;"><input type="text" name="i_options_text[]" placeholder="Option Text" style="width:180px;"/></td>',d+='<td class="action-cell"><a href="javascript:void(0)" onclick="woocfclAddNewOptionRow(this)" class="btn btn-blue" title="Add new option">+</a></td>',d+='<td class="action-cell"><a href="javascript:void(0)" onclick="woocfclRemoveOptionRow(this)" class="btn btn-red" title="Remove option">x</a></td>',d+='<td class="action-cell sort ui-sortable-handle"></td>',d+="</tr>";var u={toolbar:'<div class="input-field col s4"><select id="countries-dropdown" name="countries"></select><label>{0}</label></div>',datatable:{dom:'<"toolbar"> lfrtip',data:t,language:{url:""},deferLoading:!0,columns:[{data:"RowOrder",className:"reorder",render:function(e,t,n,o){return f.appendsHideData(e,t,n,o)}},{targets:1,searchable:!1,orderable:!1,className:"select-checkbox",checkboxes:{selectRow:!0},render:function(e,t,n,o){return f.appendsCheckboxselection(e,t,n,o)}},{data:"ID"},{data:"country",visible:!1},{data:"Name"},{data:"AdditionalCode"},{data:"NumberCode"},{data:"enabled",render:function(e,t,n,o){return f.appendswitch(e,t,n,o)}},{data:null,visible:!0,targets:8,searchable:!1,orderable:!1,className:"text-center",render:function(e,t,n,o){return f.appendsButtonEdit(e,t,n,o)}}],columnDefs:[{orderable:!1,targets:[0,1,2,3,4,5,6,7,8]}],rowReorder:{dataSrc:"RowOrder"},select:{style:"multi"},keys:{keys:[13,38,40]},initComplete:function(){this.api().columns([3]).search(e[0].ISO2).draw(),f.setToolbar(u.toolbar,[c.country]),h.setSelectControl("#countries-dropdown",e,"ISO2","Name").on("change",function(){i.columns([3]).search(this.value).draw()})}}},f={jsonUrlLang:"/wp-content/plugins/woo-chile-custom/assets/admin/vendors/datatable/i18n/{0}.json",getjsonlang:function(){return this.jsonUrlLang.replace("{0}",o)},appendsHideData:function(e,t,n,o){var i=this.setDataRow(o);return"<div class='novisible' ".concat(i,">").concat(e,"</div>")},appendswitch:function(e,t,n,o){var i=1===Number(e)?"checked":"",a=this.setDataRow(o);return'<div class="switch"><label>'.concat(c.no,'<input type="checkbox" ').concat(i,"  ").concat(a,'  class="switch"><span class="lever"></span> ').concat(c.yes,"</label></div>")},onChangeSwitch:function(){p(this).is(":checked")?i.rows().select():i.rows().deselect()},appendsCheckboxselection:function(e,t,n,o){var i=this.setDataRow(o);return'<input type="checkbox" name="id[]" class="filled-in" '.concat(i,' value="0">')},appendsButtonEdit:function(e,t,n,o){var i=this.setDataRow(o);return'<button class="btn btn-xs btn-edit" '.concat(i,' type="button" >').concat(c.edit,"</button>")},setToolbar:function(e,t){var n=e,o=0;t.forEach(function(e){n=n.replace("{".concat(o,"}"),e),o+=1}),p("div.toolbar").html(n),p(".dataTables_length").appendTo("div.toolbar"),p(".dataTables_length select").formSelect()},setDataRow:function(e){return' data-row="'.concat(e.row,'" ')},getDataRow:function(e){return a=p(e).attr("data-row"),i.row(a).data()},setOnCheckedAll:function(){p(this).is(":checked")?i.rows().select():i.rows().deselect()}},h={setSelectControl:function(e,t,n,o){var i=p(e);return i.empty(),p.each(t,function(e,t){i.append(p("<option></option>").attr("value",t[n]).text(t[o]))}),i.prop("selectedIndex",0),i.formSelect(),i},set_property_field_value:function(e,t,n,o,i){switch(t){case"select":1==i?(o="string"==typeof o?o.split(","):o,n="".concat(n,"[]"),e.find('select[name="i_'.concat(n,'"]')).val(o).trigger("change")):e.find('select[name="i_'.concat(n,'"]')).val(o);break;case"checkbox":o=1==o,e.find("input[name=i_".concat(n,"]")).prop("checked",o);break;case"textarea":o=o?w(o):o,e.find("textarea[name=i_".concat(n,"]")).val(o);break;default:o=o?w(o):o,e.find("input[name=i_".concat(n,"]")).val(o)}}},m=function(){r.fadeOut(),l.fadeIn()};function w(e){if("string"!==p.type(e))return e;var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g,function(e){return t[e]})}function b(e,t,n){var o="";switch(t){case"select":o=null==(o=e.find("select[name=i_".concat(n,"]")).val())?"":o;break;case"checkbox":o=(o=e.find("input[name=i_".concat(n,"]")).prop("checked"))?1:0;break;case"textarea":o=null==(o=e.find("textarea[name=i_".concat(n,"]")).val())?"":o;default:o=null==(o=e.find("input[name=i_".concat(n,"]")).val())?"":o}return o}function _(e,t,n,o,i){switch(t){case"select":1==i?(o="string"==typeof o?o.split(","):o,n="".concat(n,"[]"),e.find('select[name="i_'.concat(n,'"]')).val(o).trigger("change")):e.find('select[name="i_'.concat(n,'"]')).val(o);break;case"checkbox":o=1==o,e.find("input[name=i_".concat(n,"]")).prop("checked",o);break;case"textarea":o=o?w(o):o,e.find("textarea[name=i_".concat(n,"]")).val(o);break;default:o=o?w(o):o,e.find("input[name=i_".concat(n,"]")).val(o)}}function v(e){_(e,"hidden","options_json",function(e){for(var t=e.find("input[name='i_options_key[]']").map(function(){return p(this).val()}).get(),n=e.find("input[name='i_options_text[]']").map(function(){return p(this).val()}).get(),o=n.length,i=[],a=0;a<o;a++){var c={};c.key=t[a],c.text=n[a],i.push(c)}var l=0<i.length?JSON.stringify(i):"";return l=encodeURIComponent(l)}(e),0)}function g(e){var t="",n=b(e,"text","name"),o=b(e,"select","type"),i=b(e,"select","otype");return""==o&&"country"!=i&&"state"==i?t="Type is required":""==n?t="Name is required":/^[a-z\_]+[a-z0-9\_]*$/.test(n.trim())||(t='NAME/ID must begin with a lowercase letter ([a-z]) and may be followed by any number of lowercase letters, digits ([0-9]) and underscores ("_")'),""==t||(e.find(".err_msgs").html(t),!1)}function y(e,t){var n="";if(t)try{t=decodeURIComponent(t);var o=p.parseJSON(t);o&&jQuery.each(o,function(){var e="<tr>";e+='<td style="width:150px;"><input type="text" name="i_options_key[]" value="'.concat(this.key,'" placeholder="Option Value" style="width:140px;"/></td>'),e+='<td style="width:190px;"><input type="text" name="i_options_text[]" value="'.concat(this.text,'" placeholder="Option Text" style="width:180px;"/></td>'),e+='<td class="action-cell"><a href="javascript:void(0)" onclick="woocfclAddNewOptionRow(this)" class="btn btn-blue" title="Add new option">+</a></td>',e+='<td class="action-cell"><a href="javascript:void(0)" onclick="woocfclRemoveOptionRow(this)" class="btn btn-red" title="Remove option">x</a></td>',e+='<td class="action-cell sort ui-sortable-handle"></td>',n+=e+="</tr>"})}catch(e){console.log(e)}var i=e.find(".woocfcl-option-list tbody");n?i.html(n):i.html(d)}return p(function(){"states"===n.view&&(u.datatable.language.url=f.getjsonlang(),(i=p("#options-datatable").DataTable(u.datatable)).on("click","#select_all",f.setOnCheckedAll),i.on("change",".switch input[type=checkbox]",function(){var e=f.getDataRow(this),t=p(this).prop("checked")?1:0;e.enabled=t,i.row(rowId).data(e).invalidate()}),i.on("click",".btn-edit",function(){a=p(this).attr("data-row");var e=i.row(a).data();for(var t in p("#form-state-edit").get(0).reset(),p("#form-state-edit input:checkbox").removeAttr("checked"),p("#form-state-edit .modal-body input[name='RowId']").val(a),e){var n=p("#form-state-edit .modal-body input[name='".concat(t,"']"));0<n.length&&("checkbox"===n.attr("type")&&1===Number(e[t])?n.attr("checked","checked"):n.val(e[t]))}s.modal("open")}),p("#form-state-edit").on("submit",function(e){e.preventDefault();var t=i.row(a).data();for(var n in t){console.log(n);var o=p("#form-state-edit .modal-body input[name='".concat(n,"']"));0<o.length&&("checkbox"===o.attr("type")?t[n]=p(this).prop("checked")?1:0:t[n]=o.val())}console.log(t),i.row(row).data(t).invalidate(),i.draw(!1),s.modal("close")})),m(),p("#woocfcl_new_field_form_pp").dialog({modal:!0,width:600,resizable:!1,autoOpen:!1,buttons:[{text:"Save",click:function(){var e=p("#woocfcl_new_field_form");g(e)&&(v(e),e.submit())}}]}),p("#woocfcl_edit_field_form_pp").dialog({modal:!0,width:600,resizable:!1,autoOpen:!1,buttons:[{text:"Save",click:function(){var e=p("#woocfcl_edit_field_form");g(e)&&(v(e),e.submit())}}]}),p("select.woocfcl-enhanced-multi-select").select2({minimumResultsForSearch:10,allowClear:!0,placeholder:p(this).data("placeholder")}).addClass("enhanced"),p("#woocfcl_checkout_fields tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,helper:function(e,t){return t.children().each(function(){p(this).width(p(this).width())}),t.css("left","0"),t}}),p("#woocfcl_checkout_fields tbody").on("sortstart",function(e,t){t.item.css("background-color","#f6f6f6")}),p("#woocfcl_checkout_fields tbody").on("sortstop",function(e,t){t.item.removeAttr("style"),p("#woocfcl_checkout_fields tbody tr").each(function(e,t){p("input.f_order",t).val(parseInt(p(t).index("#woocfcl_checkout_fields tbody tr")))})})}),{openNewFieldForm:function(e){"billing"!=e&&"shipping"!=e&&"additional"!=e||(e="".concat(e,"_"));var t,n=p("#woocfcl_new_field_form");(t=n).find(".err_msgs").html(""),_(t,"hidden","autocomplete","",0),_(t,"hidden","priority","",0),_(t,"hidden","custom","",0),_(t,"hidden","oname","",0),_(t,"hidden","otype","",0),_(t,"select","type","text",0),_(t,"text","name","",0),_(t,"text","label","",0),_(t,"text","placeholder","",0),_(t,"text","default","",0),_(t,"text","class","",0),_(t,"select","validate","",1),_(t,"checkbox","required",1,0),_(t,"checkbox","enabled",1,0),_(t,"checkbox","show_in_email",1,0),_(t,"checkbox","show_in_order",1,0),y(t,!1),n.find("select[name=i_type]").change(),_(n,"text","name",e,0),_(n,"text","class","form-row-wide",0),p("#woocfcl_new_field_form_pp").dialog("open")},openEditFieldForm:function(e,t){var n,o,i,a,c,l,r,s=p(e).closest("tr"),d=p("#woocfcl_edit_field_form"),u=s.find(".f_props").val(),f=JSON.parse(u);n=d,i=(o=f).autocomplete?o.autocomplete:"",a=o.priority?o.priority:"",c=o.custom?o.custom:"",l=o.type?o.type:"text",r=o.name?o.name:"",_(n,"hidden","autocomplete",i,0),_(n,"hidden","priority",a,0),_(n,"hidden","custom",c,0),_(n,"hidden","oname",r,0),_(n,"hidden","otype",l,0),_(n,"select","type",l,0),_(n,"text","name",r,0),d.find("select[name=i_type]").change(),function(e,t,n,o){var o=n.custom?n.custom:"",i=n.label?n.label:"",a=n.placeholder?n.placeholder:"",c=n.default?n.default:"",l=n.class?n.class:"",r=n.validate?n.validate:"",s=n.required&&(n.required||"yes"===n.required)?1:0,d=n.enabled&&(n.enabled||"yes"===n.enabled)?1:0,u=n.show_in_email&&(n.show_in_email||"yes"===n.show_in_email)?1:0,f=n.show_in_order&&(n.show_in_order||"yes"===n.show_in_order)?1:0;u=1!=o||u,f=1!=o||f,_(t,"text","label",i,0),_(t,"text","placeholder",a,0),_(t,"text","default",c,0),_(t,"text","class",l,0),_(t,"select","validate",r,1),_(t,"checkbox","required",s,0),_(t,"checkbox","enabled",d,0),_(t,"checkbox","show_in_email",u,0),_(t,"checkbox","show_in_order",f,0);var p=e.find(".f_options").val();y(t,p),1===o?(t.find("input[name=i_name]").prop("disabled",!1),t.find("select[name=i_type]").prop("disabled",!1),t.find("input[name=i_show_in_email]").prop("disabled",!1),t.find("input[name=i_show_in_order]").prop("disabled",!1)):(t.find("input[name=i_name]").prop("disabled",!0),t.find("select[name=i_type]").prop("disabled",!0),t.find("input[name=i_show_in_email]").prop("disabled",!0),t.find("input[name=i_show_in_order]").prop("disabled",!0),t.find("input[name=i_label]").focus())}(s,d,f),p("#woocfcl_edit_field_form_pp").dialog("open")},selectAllCheckoutFields:function(e){var t=p(e).prop("checked");p("#woocfcl_checkout_fields tbody input:checkbox[name=select_field]").prop("checked",t)},removeSelectedFields:function(){p("#woocfcl_checkout_fields tbody tr").removeClass("thpladmin-strikeout"),p("#woocfcl_checkout_fields tbody input:checkbox[name=select_field]:checked").each(function(){var e=p(this).closest("tr");e.hasClass("woocfcl-strikeout")||e.addClass("woocfcl-strikeout"),e.find(".f_deleted").val(1),e.find(".f_edit_btn").prop("disabled",!0)})},enableDisableSelectedFields:function(t){p("#woocfcl_checkout_fields tbody input:checkbox[name=select_field]:checked").each(function(){var e=p(this).closest("tr");e.find(".f_enabled").val(t),0==t?(e.hasClass("woocfcl-disabled")||e.addClass("woocfcl-disabled"),e.find(".f_edit_btn").prop("disabled",!0),e.find(".td_enabled").html("-")):(e.removeClass("woocfcl-disabled"),e.find(".f_edit_btn").prop("disabled",!1),e.find(".td_enabled").html('<span class="dashicons dashicons-yes"></span>'))})},fieldTypeChangeListner:function(e){var t,n=p(e).val(),o=p(e).closest("form");(t=o).find(".row-options").show(),t.find(".row-placeholder").show(),t.find(".row-validate").show(),"select"===n?o.find(".row-validate").hide():"radio"===n?(o.find(".row-validate").hide(),o.find(".row-placeholder").hide()):o.find(".row-options").hide()},addNewOptionRow:function(e){var t=p(e).closest("table");0<t.find("tbody tr").size()?t.find("tbody tr:last").after(d):t.find("tbody").append(d)},removeOptionRow:function(e){var t=p(e).closest("table");p(e).closest("tr").remove(),0==t.find("tbody tr").size()&&t.find("tbody").append(d)}}}(window.jQuery,(window,document));function woocfclOpenNewFieldForm(e){woocfcl_settings.openNewFieldForm(e)}function woocfclOpenEditFieldForm(e,t){woocfcl_settings.openEditFieldForm(e,t)}function woocfclRemoveSelectedFields(){woocfcl_settings.removeSelectedFields()}function woocfclEnableSelectedFields(){woocfcl_settings.enableDisableSelectedFields(1)}function woocfclDisableSelectedFields(){woocfcl_settings.enableDisableSelectedFields(0)}function woocfclFieldTypeChangeListner(e){woocfcl_settings.fieldTypeChangeListner(e)}function woocfclSelectAllCheckoutFields(e){woocfcl_settings.selectAllCheckoutFields(e)}function woocfclAddNewOptionRow(e){woocfcl_settings.addNewOptionRow(e)}function woocfclRemoveOptionRow(e){woocfcl_settings.removeOptionRow(e)}